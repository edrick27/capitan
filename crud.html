<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css">
<link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap4.min.css">
<!-- <link rel="stylesheet" href="style-form.css"> -->
<style>
    .form-sponsor{
    margin: 10px 100px 0px 100px;
    width: 80%;
}
.dataTables_wrapper {
    margin: 50px;
    width: 90%;
}

.btn-save{
    width: 40%;
    margin-left: 30%;
    height: 35px;
}
</style>
<head>
        <meta charset="UTF-8">
      </head>
<div id="form-data">
    <form class="form-sponsor">
        <div class="form-group row">
            <div class="col-md-4">
                <label for="sponsorname">Sponsor name</label>
                <input v-model="form.sponsor" type="text" class="form-control" id="sponsorname"
                    placeholder="Sponsor name">
            </div>
            <div class="col-md-4">
                <label for="idtype">Type</label>
                <select v-model="form.type" class="form-control" >
                    <option value="0" disabled selected>Selecciona una opci√≥n</option>
                    <option v-for="item in types" :value="item.id">{{ item.name }}</option>
                </select>
            </div>
            <div class="col-md-4">
                <label for="money">Money</label>
                <input v-model="form.money" type="number" class="form-control" id="money" placeholder="money" required>
            </div>
        </div>
    </form>
    <button v-on:click="saveData" type="submit" class="btn btn-primary btn-save">Save</button>
</div>
<table id="data_table" class="table table-striped table-bordered ">
    <thead>
        <tr>
            <th>id</th>
            <th>sponsor</th>
            <th>type</th>
            <th>money</th>
        </tr>
    </thead>
</table>

<script>
    var vue_form;
    var data_table;

    $(document).ready(function () {
        init_dat_table();
        init_form();
    });


    function init_form() {
        vue_form = new Vue({
            el: '#form-data',
            data() {
                return {
                    form: {
                        sponsor: "",
                        type: 0,
                        money: ""
                    },
                    types: []
                }
            },
            methods: {
                saveData() {
                    $.ajax({
                        method: "POST",
                        url: "https://capitanswitzerland.000webhostapp.com/add.php",
                        data: this.form,
                    });
                    setTimeout(() => {
                        data_table.ajax.reload(null, false);
                        this.form = {
                            sponsor: "",
                            type: 0,
                            money: ""
                        };
                    }, 500);
                }
            },
            beforeCreate() {
                axios.get('https://capitanswitzerland.000webhostapp.com/get_type.php')
                .then((response) => {
                    this.types = response.data.data;
                    console.log("axios ===> ", response.data.data);
                });
            },
        });
    }

    function init_dat_table(params) {
        data_table = $('#data_table').DataTable({
            "ajax": "https://capitanswitzerland.000webhostapp.com/read.php",
            "pageLength": 25,
            "order": [[0, "desc"]],
            "columns": [
                {
                    "data": "id",
                    "visible": false
                },
                { "data": "sponsor" },
                { "data": "type" },
                { "data": "money" }
            ]
        });
    }
</script>